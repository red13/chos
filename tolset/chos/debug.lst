     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_boxfill8
     7 00000000                                 	EXTERN	_putfonts8_asc
     8 00000000                                 	EXTERN	_debug_write_num
     9 00000000                                 	EXTERN	_io_stihlt
    10 00000000                                 [FILE "debug.c"]
    11                                          [SECTION .data]
    12 00000000                                 	ALIGNB	4
    13 00000000                                 _debug_write_num:
    14 00000000 00000000                        	DD	0
    15                                          [SECTION .text]
    16 00000000                                 _print_debug_string:
    17 00000000 55                              	PUSH	EBP
    18 00000001 89 E5                           	MOV	EBP,ESP
    19 00000003 56                              	PUSH	ESI
    20 00000004 53                              	PUSH	EBX
    21 00000005 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    22 00000008 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
    23 0000000B 83 FE 07                        	CMP	ESI,7
    24 0000000E 77 17                           	JA	L1
    25 00000010 66 A1 [0000000A]                	MOV	AX,WORD [_debug_scrn_height]
    26 00000016 BA 00000008                     	MOV	EDX,8
    27 0000001B 89 D3                           	MOV	EBX,EDX
    28 0000001D 66 99                           	CWD
    29 0000001F 66 F7 FB                        	IDIV	BX
    30 00000022 98                              	CWDE
    31 00000023 39 C1                           	CMP	ECX,EAX
    32 00000025 76 07                           	JBE	L3
    33 00000027                                 L1:
    34 00000027 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    35 0000002A 5B                              	POP	EBX
    36 0000002B 5E                              	POP	ESI
    37 0000002C 5D                              	POP	EBP
    38 0000002D C3                              	RET
    39 0000002E                                 L3:
    40 0000002E 89 CB                           	MOV	EBX,ECX
    41 00000030 C1 E3 04                        	SAL	EBX,4
    42 00000033 8D 43 0F                        	LEA	EAX,DWORD [15+EBX]
    43 00000036 50                              	PUSH	EAX
    44 00000037 68 0000013F                     	PUSH	319
    45 0000003C 53                              	PUSH	EBX
    46 0000003D 6A 00                           	PUSH	0
    47 0000003F 6A 07                           	PUSH	7
    48 00000041 0F BF 05 [00000008]             	MOVSX	EAX,WORD [_debug_scrn_width]
    49 00000048 50                              	PUSH	EAX
    50 00000049 FF 35 [00000004]                	PUSH	DWORD [_debug_vram]
    51 0000004F E8 [00000000]                   	CALL	_boxfill8
    52 00000054 6B C6 28                        	IMUL	EAX,ESI,40
    53 00000057 05 [00000040]                   	ADD	EAX,_debug_buffer
    54 0000005C 50                              	PUSH	EAX
    55 0000005D 6A 00                           	PUSH	0
    56 0000005F 53                              	PUSH	EBX
    57 00000060 6A 00                           	PUSH	0
    58 00000062 0F BF 05 [00000008]             	MOVSX	EAX,WORD [_debug_scrn_width]
    59 00000069 50                              	PUSH	EAX
    60 0000006A FF 35 [00000004]                	PUSH	DWORD [_debug_vram]
    61 00000070 E8 [00000000]                   	CALL	_putfonts8_asc
    62 00000075 83 C4 34                        	ADD	ESP,52
    63 00000078 EB AD                           	JMP	L1
    64 0000007A                                 	GLOBAL	_set_debug_info
    65 0000007A                                 _set_debug_info:
    66 0000007A 55                              	PUSH	EBP
    67 0000007B 89 E5                           	MOV	EBP,ESP
    68 0000007D 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    69 00000080 A3 [00000004]                   	MOV	DWORD [_debug_vram],EAX
    70 00000085 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    71 00000088 66 A3 [00000008]                	MOV	WORD [_debug_scrn_width],AX
    72 0000008E 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    73 00000091 66 A3 [0000000A]                	MOV	WORD [_debug_scrn_height],AX
    74 00000097 5D                              	POP	EBP
    75 00000098 C3                              	RET
    76 00000099                                 	GLOBAL	_debug_print
    77 00000099                                 _debug_print:
    78 00000099 55                              	PUSH	EBP
    79 0000009A 83 C9 FF                        	OR	ECX,-1
    80 0000009D 89 E5                           	MOV	EBP,ESP
    81 0000009F 31 C0                           	XOR	EAX,EAX
    82 000000A1 57                              	PUSH	EDI
    83 000000A2 56                              	PUSH	ESI
    84 000000A3 53                              	PUSH	EBX
    85 000000A4 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
    86 000000A7 FC                              	CLD
    87 000000A8 89 DF                           	MOV	EDI,EBX
    88 000000AA F2                              	REPNE
    89 000000AB AE                              	SCASB
    90 000000AC F7 D1                           	NOT	ECX
    91 000000AE 49                              	DEC	ECX
    92 000000AF 83 F9 28                        	CMP	ECX,40
    93 000000B2 76 05                           	JBE	L6
    94 000000B4 B9 00000028                     	MOV	ECX,40
    95 000000B9                                 L6:
    96 000000B9 FC                              	CLD
    97 000000BA 89 DE                           	MOV	ESI,EBX
    98 000000BC BF [00000010]                   	MOV	EDI,_debug_string
    99 000000C1 F3                              	REP
   100 000000C2 A4                              	MOVSB
   101 000000C3 6A 0F                           	PUSH	15
   102 000000C5 68 0000013F                     	PUSH	319
   103 000000CA 6A 00                           	PUSH	0
   104 000000CC 6A 00                           	PUSH	0
   105 000000CE 6A 00                           	PUSH	0
   106 000000D0 0F BF 05 [00000008]             	MOVSX	EAX,WORD [_debug_scrn_width]
   107 000000D7 50                              	PUSH	EAX
   108 000000D8 FF 35 [00000004]                	PUSH	DWORD [_debug_vram]
   109 000000DE E8 [00000000]                   	CALL	_boxfill8
   110 000000E3 53                              	PUSH	EBX
   111 000000E4 6A 07                           	PUSH	7
   112 000000E6 6A 00                           	PUSH	0
   113 000000E8 6A 00                           	PUSH	0
   114 000000EA 0F BF 05 [00000008]             	MOVSX	EAX,WORD [_debug_scrn_width]
   115 000000F1 50                              	PUSH	EAX
   116 000000F2 FF 35 [00000004]                	PUSH	DWORD [_debug_vram]
   117 000000F8 E8 [00000000]                   	CALL	_putfonts8_asc
   118 000000FD 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   119 00000100 5B                              	POP	EBX
   120 00000101 5E                              	POP	ESI
   121 00000102 5F                              	POP	EDI
   122 00000103 5D                              	POP	EBP
   123 00000104 C3                              	RET
   124 00000105                                 	GLOBAL	_push_debug_string
   125 00000105                                 _push_debug_string:
   126 00000105 55                              	PUSH	EBP
   127 00000106 83 C9 FF                        	OR	ECX,-1
   128 00000109 89 E5                           	MOV	EBP,ESP
   129 0000010B 31 C0                           	XOR	EAX,EAX
   130 0000010D 57                              	PUSH	EDI
   131 0000010E 56                              	PUSH	ESI
   132 0000010F 53                              	PUSH	EBX
   133 00000110 52                              	PUSH	EDX
   134 00000111 FC                              	CLD
   135 00000112 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   136 00000115 F2                              	REPNE
   137 00000116 AE                              	SCASB
   138 00000117 F7 D1                           	NOT	ECX
   139 00000119 8D 59 FF                        	LEA	EBX,DWORD [-1+ECX]
   140 0000011C 83 FB 28                        	CMP	EBX,40
   141 0000011F 76 05                           	JBE	L8
   142 00000121 BB 00000028                     	MOV	EBX,40
   143 00000126                                 L8:
   144 00000126 8B 15 [00000000]                	MOV	EDX,DWORD [_debug_write_num]
   145 0000012C 31 C0                           	XOR	EAX,EAX
   146 0000012E 6B F2 28                        	IMUL	ESI,EDX,40
   147 00000131 FC                              	CLD
   148 00000132 8D BE [00000040]                	LEA	EDI,DWORD [_debug_buffer+ESI]
   149 00000138 B9 0000000A                     	MOV	ECX,10
   150 0000013D F3                              	REP
   151 0000013E AB                              	STOSD
   152 0000013F 42                              	INC	EDX
   153 00000140 8D BE [00000040]                	LEA	EDI,DWORD [_debug_buffer+ESI]
   154 00000146 89 D9                           	MOV	ECX,EBX
   155 00000148 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   156 0000014B F3                              	REP
   157 0000014C A4                              	MOVSB
   158 0000014D 83 FA 07                        	CMP	EDX,7
   159 00000150 89 15 [00000000]                	MOV	DWORD [_debug_write_num],EDX
   160 00000156 76 0A                           	JBE	L7
   161 00000158 C7 05 [00000000] 00000000       	MOV	DWORD [_debug_write_num],0
   162 00000162                                 L7:
   163 00000162 58                              	POP	EAX
   164 00000163 5B                              	POP	EBX
   165 00000164 5E                              	POP	ESI
   166 00000165 5F                              	POP	EDI
   167 00000166 5D                              	POP	EBP
   168 00000167 C3                              	RET
   169 00000168                                 	GLOBAL	_dump_debug_string
   170 00000168                                 _dump_debug_string:
   171 00000168 55                              	PUSH	EBP
   172 00000169 89 E5                           	MOV	EBP,ESP
   173 0000016B 56                              	PUSH	ESI
   174 0000016C 53                              	PUSH	EBX
   175 0000016D 31 F6                           	XOR	ESI,ESI
   176 0000016F 8B 1D [00000000]                	MOV	EBX,DWORD [_debug_write_num]
   177 00000175                                 L16:
   178 00000175 56                              	PUSH	ESI
   179 00000176 53                              	PUSH	EBX
   180 00000177 43                              	INC	EBX
   181 00000178 E8 FFFFFE83                     	CALL	_print_debug_string
   182 0000017D 83 FB 07                        	CMP	EBX,7
   183 00000180 59                              	POP	ECX
   184 00000181 58                              	POP	EAX
   185 00000182 7E 02                           	JLE	L13
   186 00000184 31 DB                           	XOR	EBX,EBX
   187 00000186                                 L13:
   188 00000186 46                              	INC	ESI
   189 00000187 83 FE 07                        	CMP	ESI,7
   190 0000018A 7E E9                           	JLE	L16
   191 0000018C 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   192 0000018F 5B                              	POP	EBX
   193 00000190 5E                              	POP	ESI
   194 00000191 5D                              	POP	EBP
   195 00000192 C3                              	RET
   196 00000193                                 	GLOBAL	_assert
   197 00000193                                 _assert:
   198 00000193 55                              	PUSH	EBP
   199 00000194 89 E5                           	MOV	EBP,ESP
   200 00000196 E8 FFFFFFCD                     	CALL	_dump_debug_string
   201 0000019B E8 [00000000]                   	CALL	_io_stihlt
   202 000001A0                                 L20:
   203 000001A0 EB FE                           	JMP	L20
   204                                          [SECTION .data]
   205 00000004                                 	ALIGNB	4
   206 00000004                                 _debug_vram:
   207 00000004 00 00 00 00                     	RESB	4
   208                                          [SECTION .data]
   209 00000008                                 	ALIGNB	2
   210 00000008                                 _debug_scrn_width:
   211 00000008 00 00                           	RESB	2
   212                                          [SECTION .data]
   213 0000000A                                 	ALIGNB	2
   214 0000000A                                 _debug_scrn_height:
   215 0000000A 00 00                           	RESB	2
   216                                          [SECTION .data]
   217 0000000C 00 00 00 00                     	ALIGNB	16
   218 00000010                                 _debug_string:
   219 00000010 00 00 00 00 00 00 00 00 00 00   	RESB	40
       0000001A 00 00 00 00 00 00 00 00 00 00 
       00000024 00 00 00 00 00 00 00 00 00 00 
       0000002E 00 00 00 00 00 00 00 00 00 00 
   220                                          [SECTION .data]
   221 00000038 00 00 00 00 00 00 00 00         	ALIGNB	16
   222 00000040                                 _debug_buffer:
   223 00000040 00 00 00 00 00 00 00 00 00 00   	RESB	320
       0000004A 00 00 00 00 00 00 00 00 00 00 
       00000054 00 00 00 00 00 00 00 00 00 00 
       0000005E 00 00 00 00 00 00 00 00 00 00 
       00000068 00 00 00 00 00 00 00 00 00 00 
       00000072 00 00 00 00 00 00 00 00 00 00 
       0000007C 00 00 00 00 00 00 00 00 00 00 
       00000086 00 00 00 00 00 00 00 00 00 00 
       00000090 00 00 00 00 00 00 00 00 00 00 
       0000009A 00 00 00 00 00 00 00 00 00 00 
       000000A4 00 00 00 00 00 00 00 00 00 00 
       000000AE 00 00 00 00 00 00 00 00 00 00 
       000000B8 00 00 00 00 00 00 00 00 00 00 
       000000C2 00 00 00 00 00 00 00 00 00 00 
       000000CC 00 00 00 00 00 00 00 00 00 00 
       000000D6 00 00 00 00 00 00 00 00 00 00 
       000000E0 00 00 00 00 00 00 00 00 00 00 
       000000EA 00 00 00 00 00 00 00 00 00 00 
       000000F4 00 00 00 00 00 00 00 00 00 00 
       000000FE 00 00 00 00 00 00 00 00 00 00 
       00000108 00 00 00 00 00 00 00 00 00 00 
       00000112 00 00 00 00 00 00 00 00 00 00 
       0000011C 00 00 00 00 00 00 00 00 00 00 
       00000126 00 00 00 00 00 00 00 00 00 00 
       00000130 00 00 00 00 00 00 00 00 00 00 
       0000013A 00 00 00 00 00 00 00 00 00 00 
       00000144 00 00 00 00 00 00 00 00 00 00 
       0000014E 00 00 00 00 00 00 00 00 00 00 
       00000158 00 00 00 00 00 00 00 00 00 00 
       00000162 00 00 00 00 00 00 00 00 00 00 
       0000016C 00 00 00 00 00 00 00 00 00 00 
       00000176 00 00 00 00 00 00 00 00 00 00 
